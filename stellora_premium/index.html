<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stellora ‚Äî Where Space Meets Insight</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,600;0,800;0,900;1,300&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
:root{
  --ink:#020510;
  --ink2:#050d1a;
  --glass:rgba(255,255,255,0.04);
  --glass2:rgba(255,255,255,0.07);
  --border:rgba(255,255,255,0.08);
  --border2:rgba(255,255,255,0.14);
  --ice:#e0f2ff;
  --cyan:#38bdf8;
  --cyan2:#7dd3fc;
  --violet:#8b5cf6;
  --violet2:#a78bfa;
  --gold:#f59e0b;
  --rose:#f43f5e;
  --emerald:#10b981;
  --dim:#4b6080;
  --mid:#8ba3bf;
  --font-display:'Exo 2',sans-serif;
  --font-mono:'Space Mono',monospace;
}
html{scroll-behavior:smooth;overflow-x:hidden;}
body{
  background:var(--ink);
  color:var(--ice);
  font-family:var(--font-display);
  overflow-x:hidden;
  cursor:none;
}

/* ‚îÄ‚îÄ CUSTOM CURSOR ‚îÄ‚îÄ */
.cursor{
  position:fixed;width:12px;height:12px;
  background:var(--cyan);border-radius:50%;
  pointer-events:none;z-index:9999;
  transform:translate(-50%,-50%);
  transition:width 0.2s,height 0.2s,background 0.2s;
  mix-blend-mode:screen;
}
.cursor-ring{
  position:fixed;width:36px;height:36px;
  border:1px solid rgba(56,189,248,0.4);
  border-radius:50%;pointer-events:none;z-index:9998;
  transform:translate(-50%,-50%);
  transition:all 0.12s ease;
}
body:has(a:hover) .cursor,
body:has(button:hover) .cursor{width:20px;height:20px;background:var(--violet);}

/* ‚îÄ‚îÄ THREE.JS CANVAS ‚îÄ‚îÄ */
#three-canvas{
  position:fixed;top:0;left:0;
  width:100%;height:100%;
  z-index:0;pointer-events:none;
}

/* ‚îÄ‚îÄ PARTICLE CANVAS ‚îÄ‚îÄ */
#particle-canvas{
  position:fixed;top:0;left:0;
  width:100%;height:100%;
  z-index:1;pointer-events:none;
}

/* ‚îÄ‚îÄ NAV ‚îÄ‚îÄ */
nav{
  position:fixed;top:0;left:0;right:0;z-index:200;
  padding:20px 60px;
  display:flex;align-items:center;justify-content:space-between;
  background:linear-gradient(180deg,rgba(2,5,16,0.9) 0%,transparent 100%);
  backdrop-filter:blur(12px);
}
.nav-logo{
  font-family:var(--font-display);
  font-size:1.1rem;font-weight:900;
  letter-spacing:6px;text-transform:uppercase;
  background:linear-gradient(135deg,var(--cyan),var(--violet2));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}
.nav-links{display:flex;gap:40px;list-style:none;}
.nav-links a{
  font-family:var(--font-mono);font-size:0.65rem;
  color:var(--dim);text-decoration:none;
  letter-spacing:2px;text-transform:uppercase;
  transition:color 0.3s;position:relative;
}
.nav-links a::after{
  content:'';position:absolute;bottom:-4px;left:0;right:0;
  height:1px;background:var(--cyan);
  transform:scaleX(0);transform-origin:left;transition:transform 0.3s;
}
.nav-links a:hover{color:var(--cyan);}
.nav-links a:hover::after{transform:scaleX(1);}
@media(max-width:768px){.nav-links{display:none;} nav{padding:20px 24px;}}

/* ‚îÄ‚îÄ WRAP ‚îÄ‚îÄ */
.wrap{max-width:1200px;margin:0 auto;padding:0 60px;position:relative;z-index:10;}
@media(max-width:768px){.wrap{padding:0 24px;}}

/* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
#hero{
  min-height:100vh;display:flex;align-items:center;
  position:relative;overflow:hidden;
}
.hero-content{max-width:680px;padding-top:80px;}

.hero-tag{
  display:inline-flex;align-items:center;gap:8px;
  padding:6px 16px;
  background:rgba(56,189,248,0.06);
  border:1px solid rgba(56,189,248,0.15);
  border-radius:100px;
  font-family:var(--font-mono);font-size:0.62rem;
  color:var(--cyan);letter-spacing:2px;text-transform:uppercase;
  margin-bottom:32px;
  animation:fade-up 0.8s ease both;
}
.tag-pulse{
  width:6px;height:6px;border-radius:50%;
  background:var(--cyan);
  animation:pulse 2s ease infinite;
}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1);}50%{opacity:0.3;transform:scale(0.7);}}

h1{
  font-size:clamp(3.5rem,8vw,7rem);
  font-weight:900;line-height:0.92;
  letter-spacing:-3px;
  margin-bottom:28px;
  animation:fade-up 0.8s 0.1s ease both;
}
h1 .w1{display:block;color:var(--ice);}
h1 .w2{
  display:block;
  background:linear-gradient(135deg,var(--cyan) 0%,var(--violet2) 50%,var(--gold) 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  filter:drop-shadow(0 0 30px rgba(56,189,248,0.3));
}
h1 .w3{display:block;color:var(--ice);font-weight:200;font-style:italic;font-size:0.7em;letter-spacing:0;}

.hero-desc{
  font-size:1.05rem;color:var(--mid);line-height:1.9;
  font-weight:300;max-width:520px;margin-bottom:44px;
  animation:fade-up 0.8s 0.2s ease both;
}

.hero-btns{
  display:flex;gap:14px;flex-wrap:wrap;
  animation:fade-up 0.8s 0.3s ease both;
}
.btn{
  padding:15px 32px;border-radius:6px;
  font-family:var(--font-display);font-size:0.85rem;font-weight:700;
  letter-spacing:1px;text-decoration:none;cursor:pointer;
  border:none;display:inline-flex;align-items:center;gap:10px;
  transition:all 0.3s;position:relative;overflow:hidden;
}
.btn::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(255,255,255,0.1),transparent);
  opacity:0;transition:opacity 0.3s;
}
.btn:hover::before{opacity:1;}
.btn-glow{
  background:linear-gradient(135deg,var(--cyan),var(--violet));
  color:white;
}
.btn-glow:hover{transform:translateY(-3px);box-shadow:0 12px 40px rgba(56,189,248,0.4);}
.btn-ghost{
  background:var(--glass);color:var(--mid);
  border:1px solid var(--border2);
  backdrop-filter:blur(10px);
}
.btn-ghost:hover{border-color:var(--cyan2);color:var(--cyan2);transform:translateY(-3px);}

/* HERO 3D OBJECT */
.hero-3d{
  position:absolute;right:-100px;top:50%;
  transform:translateY(-50%);
  width:600px;height:600px;
  pointer-events:none;
  animation:fade-up 1s 0.4s ease both;
}
@media(max-width:1100px){.hero-3d{display:none;}}

/* HERO METRICS */
.hero-metrics{
  display:flex;gap:40px;margin-top:60px;
  padding-top:40px;border-top:1px solid var(--border);
  animation:fade-up 0.8s 0.4s ease both;
}
.metric{}
.metric-val{
  font-family:var(--font-mono);font-size:1.8rem;font-weight:700;
  color:var(--cyan);line-height:1;margin-bottom:4px;
}
.metric-label{font-size:0.75rem;color:var(--dim);letter-spacing:1px;text-transform:uppercase;}

@keyframes fade-up{from{opacity:0;transform:translateY(32px);}to{opacity:1;transform:none;}}

/* ‚îÄ‚îÄ SECTION COMMON ‚îÄ‚îÄ */
section{padding:120px 0;position:relative;z-index:10;}
.s-tag{
  font-family:var(--font-mono);font-size:0.62rem;
  color:var(--cyan);letter-spacing:3px;text-transform:uppercase;
  margin-bottom:14px;opacity:0.8;
}
.s-title{
  font-size:clamp(2rem,4vw,3.2rem);font-weight:900;
  letter-spacing:-1px;margin-bottom:16px;line-height:1.05;
}
.s-desc{font-size:1rem;color:var(--mid);max-width:560px;line-height:1.9;font-weight:300;}

/* ‚îÄ‚îÄ GLASS CARD ‚îÄ‚îÄ */
.glass-card{
  background:var(--glass);
  border:1px solid var(--border);
  border-radius:20px;
  backdrop-filter:blur(20px);
  -webkit-backdrop-filter:blur(20px);
  position:relative;overflow:hidden;
  transition:all 0.4s cubic-bezier(.16,1,.3,1);
}
.glass-card::before{
  content:'';position:absolute;
  inset:0;border-radius:20px;
  background:linear-gradient(135deg,rgba(255,255,255,0.06) 0%,transparent 60%);
  pointer-events:none;
}
.glass-card:hover{
  border-color:var(--border2);
  transform:translateY(-6px);
  box-shadow:0 24px 60px rgba(0,0,0,0.4),0 0 0 1px rgba(56,189,248,0.1);
}

/* ‚îÄ‚îÄ PIPELINE SECTION ‚îÄ‚îÄ */
#pipeline{border-top:1px solid var(--border);}

.pipeline-visual{
  margin-top:64px;position:relative;
}

.pipe-steps{
  display:grid;grid-template-columns:repeat(4,1fr);
  gap:0;position:relative;
}

/* Animated connector line */
.pipe-connector{
  position:absolute;
  top:60px;left:12.5%;right:12.5%;
  height:1px;
  background:linear-gradient(90deg,var(--cyan),var(--violet),var(--gold));
  z-index:0;
  transform-origin:left;
  animation:line-grow 2s 0.5s ease both;
}
.pipe-connector::after{
  content:'';position:absolute;
  top:-2px;left:0;right:0;height:5px;
  background:inherit;filter:blur(4px);opacity:0.5;
}
@keyframes line-grow{from{transform:scaleX(0);}to{transform:scaleX(1);}}

.pipe-step{
  display:flex;flex-direction:column;align-items:center;
  text-align:center;padding:0 16px;position:relative;z-index:1;
}
.pipe-node{
  width:120px;height:120px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:2.2rem;margin-bottom:24px;
  position:relative;cursor:default;
  transition:all 0.3s;
  animation:node-in 0.6s ease both;
}
.pipe-step:nth-child(1) .pipe-node{animation-delay:0.3s;}
.pipe-step:nth-child(2) .pipe-node{animation-delay:0.6s;}
.pipe-step:nth-child(3) .pipe-node{animation-delay:0.9s;}
.pipe-step:nth-child(4) .pipe-node{animation-delay:1.2s;}
@keyframes node-in{from{opacity:0;transform:scale(0.5);}to{opacity:1;transform:scale(1);}}

.pipe-node-1{background:rgba(56,189,248,0.1);border:1px solid rgba(56,189,248,0.3);}
.pipe-node-2{background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);}
.pipe-node-3{background:rgba(245,158,11,0.1);border:1px solid rgba(245,158,11,0.3);}
.pipe-node-4{background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);}

.pipe-node:hover{transform:scale(1.1);}
.pipe-node-1:hover{box-shadow:0 0 40px rgba(56,189,248,0.3);}
.pipe-node-2:hover{box-shadow:0 0 40px rgba(139,92,246,0.3);}
.pipe-node-3:hover{box-shadow:0 0 40px rgba(245,158,11,0.3);}
.pipe-node-4:hover{box-shadow:0 0 40px rgba(16,185,129,0.3);}

/* Pulsing ring */
.pipe-node::after{
  content:'';position:absolute;inset:-8px;
  border-radius:50%;border:1px solid currentColor;
  opacity:0;animation:ring-pulse 3s ease infinite;
}
.pipe-node-1::after{color:rgba(56,189,248,0.3);animation-delay:0s;}
.pipe-node-2::after{color:rgba(139,92,246,0.3);animation-delay:0.75s;}
.pipe-node-3::after{color:rgba(245,158,11,0.3);animation-delay:1.5s;}
.pipe-node-4::after{color:rgba(16,185,129,0.3);animation-delay:2.25s;}
@keyframes ring-pulse{0%,100%{opacity:0;transform:scale(1);}50%{opacity:1;transform:scale(1.1);}}

.pipe-title{font-weight:800;font-size:0.9rem;letter-spacing:0.5px;margin-bottom:8px;}
.pipe-desc{font-size:0.8rem;color:var(--dim);line-height:1.7;font-weight:300;}
.pipe-branch{
  margin-top:12px;padding:6px 12px;
  background:rgba(245,158,11,0.08);
  border:1px solid rgba(245,158,11,0.2);
  border-radius:100px;
  font-family:var(--font-mono);font-size:0.58rem;color:var(--gold);
  letter-spacing:1px;
}

/* ‚îÄ‚îÄ CLASSIFIER SECTION ‚îÄ‚îÄ */
#classify{border-top:1px solid var(--border);}

.classify-grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-top:56px;}
@media(max-width:800px){.classify-grid{grid-template-columns:1fr;}}

/* DROPZONE */
.dropzone{
  border:2px dashed rgba(56,189,248,0.15);
  border-radius:16px;padding:52px 24px;
  text-align:center;cursor:pointer;
  transition:all 0.3s;position:relative;
  background:rgba(56,189,248,0.02);
}
.dropzone:hover,.dropzone.over{
  border-color:var(--cyan);
  background:rgba(56,189,248,0.05);
  box-shadow:0 0 40px rgba(56,189,248,0.1) inset;
}
.dropzone input{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;}
.dz-orbit{
  width:80px;height:80px;margin:0 auto 20px;
  position:relative;display:flex;align-items:center;justify-content:center;
}
.dz-orbit-ring{
  position:absolute;inset:0;border-radius:50%;
  border:1px solid rgba(56,189,248,0.2);
  animation:orbit-spin 8s linear infinite;
}
.dz-orbit-dot{
  position:absolute;top:0;left:50%;
  width:6px;height:6px;border-radius:50%;
  background:var(--cyan);transform:translateX(-50%);
}
@keyframes orbit-spin{to{transform:rotate(360deg);}}
.dz-icon{font-size:2rem;}
.dz-title{font-weight:700;font-size:0.9rem;margin-bottom:6px;color:var(--ice);}
.dz-sub{font-size:0.78rem;color:var(--dim);font-family:var(--font-mono);}

#img-preview{display:none;margin-top:16px;}
#img-preview img{width:100%;border-radius:12px;max-height:200px;object-fit:cover;border:1px solid var(--border);}

.classify-btn{
  width:100%;margin-top:16px;padding:15px;
  background:linear-gradient(135deg,var(--cyan),var(--violet));
  color:white;border:none;border-radius:10px;cursor:pointer;
  font-family:var(--font-display);font-size:0.85rem;font-weight:800;
  letter-spacing:1px;transition:all 0.3s;
  display:flex;align-items:center;justify-content:center;gap:10px;
}
.classify-btn:hover:not(:disabled){
  transform:translateY(-2px);
  box-shadow:0 12px 40px rgba(56,189,248,0.4);
}
.classify-btn:disabled{opacity:0.4;cursor:not-allowed;}

/* RESULT */
.result-empty{
  display:flex;flex-direction:column;align-items:center;
  justify-content:center;min-height:320px;
  text-align:center;gap:16px;color:var(--dim);
}
.re-rings{
  width:80px;height:80px;position:relative;margin:0 auto;
}
.re-ring{
  position:absolute;inset:0;border-radius:50%;
  border:1px solid rgba(255,255,255,0.05);
}
.re-ring:nth-child(2){inset:12px;border-color:rgba(255,255,255,0.04);}
.re-ring:nth-child(3){inset:24px;border-color:rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center;font-size:1.2rem;}

#cnn-result{display:none;}

.detected-hero{
  padding:32px;text-align:center;
  position:relative;overflow:hidden;
}
.det-glow-bg{
  position:absolute;inset:0;
  background:radial-gradient(ellipse at 50% 100%,var(--det-bg,rgba(56,189,248,0.08)),transparent 70%);
}
.det-emoji{font-size:4rem;display:block;margin-bottom:14px;position:relative;}
.det-name{
  font-size:2.2rem;font-weight:900;letter-spacing:1px;
  color:var(--det-col,var(--cyan));
  text-shadow:0 0 40px var(--det-glow,rgba(56,189,248,0.5));
  position:relative;
}
.det-pct{
  font-family:var(--font-mono);font-size:0.72rem;
  color:var(--dim);margin-top:6px;letter-spacing:1px;position:relative;
}

.conf-section{padding:20px 24px;}
.conf-item{margin-bottom:14px;}
.conf-row{
  display:flex;justify-content:space-between;align-items:center;
  font-family:var(--font-mono);font-size:0.65rem;color:var(--mid);
  margin-bottom:6px;
}
.conf-bar{height:4px;background:rgba(255,255,255,0.05);border-radius:2px;overflow:hidden;}
.conf-fill{
  height:100%;border-radius:2px;
  transition:width 1.2s cubic-bezier(.34,1.56,.64,1);
}

/* ASTEROID ALERT */
.ast-alert{
  margin:0 20px 20px;padding:18px 20px;
  background:rgba(245,158,11,0.06);
  border:1px solid rgba(245,158,11,0.2);
  border-radius:12px;
}
.ast-alert-title{
  font-weight:800;font-size:0.82rem;color:var(--gold);
  margin-bottom:6px;display:flex;align-items:center;gap:8px;
}
.ast-alert-desc{font-size:0.8rem;color:var(--mid);line-height:1.7;margin-bottom:12px;}
.alert-btn{
  padding:9px 18px;background:var(--gold);color:var(--ink);
  border:none;border-radius:6px;cursor:pointer;
  font-family:var(--font-display);font-size:0.75rem;font-weight:800;
  letter-spacing:0.5px;transition:all 0.2s;
}
.alert-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(245,158,11,0.4);}

.obj-fact{
  margin:0 20px 20px;padding:16px 20px;
  background:rgba(255,255,255,0.02);border-radius:10px;
  border-left:2px solid var(--det-col,var(--cyan));
}
.obj-fact-label{
  font-family:var(--font-mono);font-size:0.58rem;
  color:var(--dim);letter-spacing:2px;text-transform:uppercase;margin-bottom:6px;
}
.obj-fact-text{font-size:0.83rem;color:var(--mid);line-height:1.8;font-weight:300;}

/* ‚îÄ‚îÄ ASTEROID EXPLORER ‚îÄ‚îÄ */
#explorer{border-top:1px solid var(--border);}

.explorer-layout{display:grid;grid-template-columns:320px 1fr;gap:24px;margin-top:56px;}
@media(max-width:900px){.explorer-layout{grid-template-columns:1fr;}}

.search-field{
  width:100%;padding:14px 50px 14px 18px;
  background:rgba(255,255,255,0.03);
  border:1px solid var(--border2);border-radius:10px;
  color:var(--ice);font-family:var(--font-mono);font-size:0.78rem;
  letter-spacing:0.5px;outline:none;transition:border 0.3s;
}
.search-field:focus{border-color:var(--cyan);box-shadow:0 0 0 3px rgba(56,189,248,0.1);}
.search-field::placeholder{color:var(--dim);}
.search-wrap{position:relative;margin-bottom:16px;}
.search-btn{
  position:absolute;right:0;top:0;bottom:0;width:46px;
  background:transparent;border:none;color:var(--cyan);
  cursor:pointer;font-size:1.1rem;transition:all 0.2s;
  border-radius:0 10px 10px 0;
}
.search-btn:hover{background:rgba(56,189,248,0.1);}

.known-label{
  font-family:var(--font-mono);font-size:0.58rem;
  color:var(--dim);letter-spacing:2px;text-transform:uppercase;margin-bottom:10px;
}
.chips{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:20px;}
.chip{
  padding:5px 12px;
  background:rgba(255,255,255,0.03);
  border:1px solid var(--border);border-radius:100px;
  font-family:var(--font-mono);font-size:0.6rem;color:var(--mid);
  cursor:pointer;transition:all 0.2s;letter-spacing:0.5px;
}
.chip:hover{border-color:var(--cyan2);color:var(--cyan2);background:rgba(56,189,248,0.06);}

.data-note{
  padding:14px 16px;
  background:rgba(255,255,255,0.02);
  border-radius:8px;border:1px solid var(--border);
  font-family:var(--font-mono);font-size:0.6rem;
  color:var(--dim);line-height:2;
}

/* RISK DISPLAY */
.risk-layout{display:grid;grid-template-columns:1fr 180px;gap:24px;padding:28px;align-items:start;}
@media(max-width:700px){.risk-layout{grid-template-columns:1fr;}}

.risk-name{font-size:1.3rem;font-weight:900;margin-bottom:4px;}
.risk-id{font-family:var(--font-mono);font-size:0.62rem;color:var(--dim);margin-bottom:20px;}

.fact-list{display:flex;flex-direction:column;gap:8px;}
.fact-row{
  display:flex;align-items:center;gap:12px;
  padding:10px 14px;background:rgba(255,255,255,0.025);
  border-radius:8px;border-left:2px solid transparent;
  transition:border-color 0.2s;
}
.fact-row:hover{border-color:var(--cyan);}
.fact-ico{font-size:1rem;width:22px;text-align:center;}
.fact-body{flex:1;}
.fact-lbl{font-family:var(--font-mono);font-size:0.58rem;color:var(--dim);letter-spacing:1px;text-transform:uppercase;}
.fact-val{font-size:0.85rem;margin-top:2px;font-weight:600;}
.fact-side{font-family:var(--font-mono);font-size:0.65rem;color:var(--dim);}

/* GAUGE */
.gauge-wrap{text-align:center;}
.gauge-pct{
  font-family:var(--font-mono);font-size:2.8rem;font-weight:700;
  line-height:1;margin-top:-6px;
}
.gauge-sub{font-family:var(--font-mono);font-size:0.58rem;color:var(--dim);letter-spacing:2px;margin-top:4px;}
.verdict{
  display:inline-block;margin-top:12px;
  padding:6px 14px;border-radius:100px;
  font-family:var(--font-mono);font-size:0.58rem;font-weight:700;
  letter-spacing:1.5px;text-transform:uppercase;
}
.v-high{background:rgba(244,63,94,0.1);color:var(--rose);border:1px solid rgba(244,63,94,0.25);}
.v-med{background:rgba(245,158,11,0.1);color:var(--gold);border:1px solid rgba(245,158,11,0.2);}
.v-low{background:rgba(16,185,129,0.1);color:var(--emerald);border:1px solid rgba(16,185,129,0.2);}

.nasa-tag{
  margin:0 28px 24px;padding:12px 16px;border-radius:8px;
  font-family:var(--font-mono);font-size:0.65rem;line-height:1.6;
}
.nasa-pho{background:rgba(244,63,94,0.06);border:1px solid rgba(244,63,94,0.15);color:var(--rose);}
.nasa-safe{background:rgba(16,185,129,0.06);border:1px solid rgba(16,185,129,0.15);color:var(--emerald);}

.exp-empty{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  min-height:360px;gap:16px;color:var(--dim);
  font-family:var(--font-mono);font-size:0.72rem;text-align:center;
}
.exp-empty-icon{font-size:3rem;opacity:0.15;}

/* TERMINAL TYPING */
.terminal-output{
  font-family:var(--font-mono);font-size:0.72rem;
  color:var(--cyan);line-height:2;
}
.t-line{display:block;}
.t-cursor{
  display:inline-block;width:7px;height:13px;
  background:var(--cyan);vertical-align:middle;
  animation:blink-cur 1s step-end infinite;
}
@keyframes blink-cur{0%,100%{opacity:1;}50%{opacity:0;}}

/* ‚îÄ‚îÄ LIVE RADAR ‚îÄ‚îÄ */
#radar{border-top:1px solid var(--border);}

.radar-layout{display:grid;grid-template-columns:340px 1fr;gap:24px;margin-top:56px;}
@media(max-width:900px){.radar-layout{grid-template-columns:1fr;}}

#radarCanvas{display:block;border-radius:50%;}
.radar-panel-inner{padding:24px;display:flex;flex-direction:column;align-items:center;}
.radar-panel-label{
  font-family:var(--font-mono);font-size:0.58rem;color:var(--cyan);
  letter-spacing:2px;text-transform:uppercase;margin-bottom:14px;
  opacity:0.7;align-self:flex-start;
}
.radar-legend{
  display:flex;gap:16px;margin-top:14px;
  font-family:var(--font-mono);font-size:0.58rem;color:var(--dim);
}
.rl{display:flex;align-items:center;gap:6px;}
.rl-dot{width:7px;height:7px;border-radius:50%;}

/* STATS STRIP */
.stats-strip{
  display:grid;grid-template-columns:repeat(4,1fr);
  gap:1px;background:var(--border);
  border:1px solid var(--border);border-radius:14px;
  overflow:hidden;margin-bottom:20px;
}
.stat-cell{
  background:var(--ink2);padding:16px 20px;text-align:center;
  transition:background 0.2s;
}
.stat-cell:hover{background:var(--glass);}
.stat-n{
  font-family:var(--font-mono);font-size:1.5rem;font-weight:700;
  line-height:1;margin-bottom:4px;
}
.stat-l{font-family:var(--font-mono);font-size:0.55rem;color:var(--dim);letter-spacing:1px;text-transform:uppercase;}

/* DATE NAV */
.date-nav{display:flex;align-items:center;gap:8px;margin-bottom:16px;}
.d-btn{
  padding:7px 14px;background:var(--glass);
  border:1px solid var(--border);border-radius:6px;
  color:var(--mid);font-family:var(--font-mono);font-size:0.6rem;
  cursor:pointer;transition:all 0.2s;letter-spacing:1px;
}
.d-btn:hover{border-color:var(--cyan);color:var(--cyan);}
.d-btn.active{background:rgba(56,189,248,0.08);border-color:var(--cyan);color:var(--cyan);}
.d-date{font-family:var(--font-mono);font-size:0.62rem;color:var(--mid);margin-left:auto;}

/* NEO TABLE */
.neo-table{max-height:360px;overflow-y:auto;}
.neo-table::-webkit-scrollbar{width:3px;}
.neo-table::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px;}

.neo-row{
  display:grid;grid-template-columns:1fr 80px 85px 95px;
  padding:12px 20px;border-bottom:1px solid rgba(255,255,255,0.03);
  align-items:center;cursor:pointer;transition:background 0.15s;
}
.neo-row:hover{background:rgba(255,255,255,0.03);}
.neo-row.sel{background:rgba(56,189,248,0.05);border-left:2px solid var(--cyan);}
.neo-name{font-family:var(--font-mono);font-size:0.7rem;font-weight:700;}
.neo-id{font-size:0.58rem;color:var(--dim);font-family:var(--font-mono);margin-top:2px;}
.neo-val{font-family:var(--font-mono);font-size:0.65rem;color:var(--mid);text-align:right;}
.neo-val .u{font-size:0.52rem;color:var(--dim);}

.risk-tag{
  display:inline-flex;align-items:center;gap:3px;
  padding:3px 8px;border-radius:4px;
  font-family:var(--font-mono);font-size:0.55rem;font-weight:700;letter-spacing:0.5px;
}
.rt-h{background:rgba(244,63,94,0.1);color:var(--rose);border:1px solid rgba(244,63,94,0.2);}
.rt-m{background:rgba(245,158,11,0.08);color:var(--gold);border:1px solid rgba(245,158,11,0.18);}
.rt-l{background:rgba(16,185,129,0.07);color:var(--emerald);border:1px solid rgba(16,185,129,0.15);}

/* DETAIL STRIP */
.detail-strip{
  display:grid;grid-template-columns:repeat(3,1fr);
  gap:12px;padding:16px 20px;
  border-top:1px solid var(--border);
}
.ds-item{padding:14px;background:rgba(255,255,255,0.02);border-radius:8px;}
.ds-lbl{font-family:var(--font-mono);font-size:0.55rem;color:var(--dim);letter-spacing:1.5px;text-transform:uppercase;margin-bottom:6px;}
.ds-val{font-family:var(--font-mono);font-size:1rem;font-weight:700;}
.ds-sub{font-size:0.72rem;color:var(--mid);margin-top:3px;}

/* LOADING */
.loading{
  display:flex;flex-direction:column;align-items:center;
  justify-content:center;min-height:300px;gap:16px;
}
.spin{
  width:40px;height:40px;
  border:2px solid rgba(56,189,248,0.1);
  border-top-color:var(--cyan);border-radius:50%;
  animation:spin 0.9s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg);}}
.spin-txt{font-family:var(--font-mono);font-size:0.62rem;color:var(--dim);letter-spacing:2px;}

/* FOOTER */
footer{
  border-top:1px solid var(--border);
  padding:40px 0;position:relative;z-index:10;
}
.footer-row{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px;}
.footer-logo{
  font-family:var(--font-display);font-size:0.9rem;font-weight:900;
  letter-spacing:4px;
  background:linear-gradient(135deg,var(--cyan),var(--violet2));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}
.footer-copy{font-family:var(--font-mono);font-size:1rem;color:var(--dim);}
.footer-links{display:flex;gap:24px;}
.footer-links a{font-family:var(--font-mono);font-size:1rem;color:var(--dim);text-decoration:none;transition:color 0.2s;}
.footer-links a:hover{color:var(--cyan);}

/* REVEAL */
.reveal{opacity:0;transform:translateY(28px);transition:all 0.8s cubic-bezier(.16,1,.3,1);}
.reveal.in{opacity:1;transform:none;}
.reveal-delay-1{transition-delay:0.1s;}
.reveal-delay-2{transition-delay:0.2s;}
.reveal-delay-3{transition-delay:0.3s;}

/* MOBILE */
@media(max-width:768px){
  h1{letter-spacing:-2px;}
  .hero-metrics{gap:24px;}
  .pipe-steps{grid-template-columns:1fr 1fr;gap:24px;}
  .pipe-connector{display:none;}
  .stats-strip{grid-template-columns:repeat(2,1fr);}
  .detail-strip{grid-template-columns:1fr 1fr;}
}
</style>
</head>
<body>

<!-- CURSOR -->
<div class="cursor" id="cursor"></div>
<div class="cursor-ring" id="cursor-ring"></div>

<!-- THREE.JS CANVAS -->
<canvas id="three-canvas"></canvas>

<!-- PARTICLE CANVAS -->
<canvas id="particle-canvas"></canvas>

<!-- NAV -->
<nav>
<div class="nav-logo">Stellora</div>
  <ul class="nav-links">
    <li><a href="#pipeline">Pipeline</a></li>
    <li><a href="#classify">Classify</a></li>
    <li><a href="#explorer">Explorer</a></li>
    <li><a href="#radar">Live Radar</a></li>
  </ul>
</nav>

<!-- ‚ïê‚ïê HERO ‚ïê‚ïê -->
<section id="hero">
<div class="wrap">
  <div class="hero-content">
    <div class="hero-tag"><span class="tag-pulse"></span>Where Space Meets Insight</div>
    <h1>
      <span class="w1">Decode</span>
      <span class="w2">the Cosmos</span>
      <span class="w3">with machine intelligence</span>
    </h1>
    <p class="hero-desc">Two neural networks working in tandem ‚Äî ResNet50 classifies your telescope images while Random Forest scores asteroid threats using live NASA orbital data.</p>
    <div class="hero-btns">
      <a href="#classify" class="btn btn-glow">üî≠ Classify Image</a>
      <a href="#radar" class="btn btn-ghost">‚óé Live Radar</a>
    </div>
    <div class="hero-metrics">
      <div class="metric"><div class="metric-val">4</div><div class="metric-label">Object Classes</div></div>
      <div class="metric"><div class="metric-val">2</div><div class="metric-label">AI Models</div></div>
      <div class="metric"><div class="metric-val">Live</div><div class="metric-label">NASA Feed</div></div>
      <div class="metric"><div class="metric-val">200</div><div class="metric-label">RF Trees</div></div>
    </div>
  </div>
</div>
</section>

<!-- ‚ïê‚ïê PIPELINE ‚ïê‚ïê -->
<section id="pipeline">
<div class="wrap">
  <div class="reveal">
    <div class="s-tag">// system architecture</div>
    <h2 class="s-title">Two AI Brains, One Pipeline</h2>
    <p class="s-desc">A seamless flow from raw telescope image to actionable risk intelligence.</p>
  </div>
  <div class="pipeline-visual reveal reveal-delay-1">
    <div class="pipe-connector"></div>
    <div class="pipe-steps">
      <div class="pipe-step">
        <div class="pipe-node pipe-node-1">üñºÔ∏è</div>
        <div class="pipe-title">Image Input</div>
        <div class="pipe-desc">Upload any astronomical telescope image ‚Äî JPG, PNG, FITS</div>
      </div>
      <div class="pipe-step">
        <div class="pipe-node pipe-node-2">üß†</div>
        <div class="pipe-title">CNN Classify</div>
        <div class="pipe-desc">ResNet50 identifies Galaxy, Star, Nebula, or Planet</div>
      </div>
      <div class="pipe-step">
        <div class="pipe-node pipe-node-3">‚òÑÔ∏è</div>
        <div class="pipe-title">Asteroid Check</div>
        <div class="pipe-desc">Pipeline branches if object matches asteroid signature</div>
        <div class="pipe-branch">IF asteroid ‚Üí RF model</div>
      </div>
      <div class="pipe-step">
        <div class="pipe-node pipe-node-4">üå≤</div>
        <div class="pipe-title">Risk Score</div>
        <div class="pipe-desc">Random Forest scores hazard probability from NASA orbital data</div>
      </div>
    </div>
  </div>
</div>
</section>

<!-- ‚ïê‚ïê CLASSIFY ‚ïê‚ïê -->
<section id="classify">
<div class="wrap">
  <div class="reveal">
    <div class="s-tag">// model_01 ¬∑ resnet50</div>
<h2 class="s-title">Object Classifier</h2>
<p class="s-desc">Upload a telescope image. The CNN identifies the astronomical object type with confidence scores.</p>

<div style="margin-top:24px;padding:20px 24px;background:rgba(56,189,248,0.08);border:1px solid rgba(56,189,248,0.25);border-radius:14px;font-family:var(--font-mono);font-size:0.88rem;line-height:2;color:var(--mid);">
  <div style="color:var(--cyan);font-size:0.8rem;letter-spacing:2px;margin-bottom:10px;">// CLASSIFICATION SCOPE</div>
  This model is trained to identify: &nbsp;
  üåå <strong style="color:var(--ice)">Galaxies</strong> (Spiral, Elliptical) &nbsp;¬∑&nbsp;
  ‚≠ê <strong style="color:var(--ice)">Stars</strong> (Point-source luminaries) &nbsp;¬∑&nbsp;
  üå† <strong style="color:var(--ice)">Nebulae</strong> (Interstellar clouds) &nbsp;¬∑&nbsp;
  ü™ê <strong style="color:var(--ice)">Planets</strong> (Spherical celestial bodies)
  <div style="margin-top:12px;padding-top:12px;border-top:1px solid rgba(255,255,255,0.05);">
    <div style="color:var(--cyan);font-size:0.65rem;letter-spacing:2px;margin-bottom:8px;">// MODEL DIAGNOSTICS</div>
    <span style="color:var(--emerald)">‚úì</span> Overall Accuracy: <strong style="color:var(--ice)">79.31%</strong> &nbsp;¬∑&nbsp;
    <span style="color:var(--emerald)">‚úì</span> Planet Recall: <strong style="color:var(--emerald)">97%</strong> (strongest class) &nbsp;¬∑&nbsp;
    <span style="color:var(--gold)">‚ö†</span> Galaxy Recall: <strong style="color:var(--gold)">67%</strong> (may miss faint/low-res galaxies)
    <div style="margin-top:8px;color:var(--mid);font-size:0.75rem;">
     <b> ‚ö† Other objects outside these 4 classes may yield inaccurate results.<br>
üìä Overall CNN Accuracy: <strong style="color:var(--ice)">79.31%</strong> ¬∑ 
Planet <strong style="color:var(--emerald)">97%</strong> ¬∑ 
Nebula <strong style="color:var(--emerald)">82%</strong> ¬∑ 
Star <strong style="color:var(--cyan)">74%</strong> ¬∑ 
Galaxy <strong style="color:var(--gold)">67%</strong> recall
``` </b>
    </div>
  </div>
</div>
  </div>
  <div class="classify-grid">
    <div class="glass-card reveal reveal-delay-1" style="padding:24px;">
      <div class="dropzone" id="dropzone">
        <input type="file" accept="image/*" id="img-input">
        <div class="dz-orbit">
          <div class="dz-orbit-ring"><div class="dz-orbit-dot"></div></div>
          <div class="dz-icon">üî≠</div>
        </div>
        <div class="dz-title">Upload Astronomical Image</div>
        <div class="dz-sub">drag & drop or click ¬∑ jpg ¬∑ png ¬∑ fits<br>
<span style="color:var(--gold);font-size:0.68rem;">‚ö† Use high-quality, clear telescope images for best results</span></div>
      </div>
      <div id="img-preview"><img id="preview-img" src="" alt=""></div>
      <button class="classify-btn" id="classify-btn" disabled>
        <span id="cbtn-txt">‚ñ∂ Analyze Object</span>
        <div class="spin" id="cbtn-spin" style="display:none;width:16px;height:16px;border-width:1.5px;"></div>
      </button>
    </div>

    <div class="glass-card reveal reveal-delay-2">
      <div class="result-empty" id="cnn-empty">
        <div class="re-rings">
          <div class="re-ring"></div>
          <div class="re-ring"></div>
          <div class="re-ring">üåå</div>
        </div>
        <span style="font-family:var(--font-mono);font-size:0.7rem;">Awaiting image input...</span>
      </div>
      <div id="cnn-result">
        <div class="detected-hero" id="det-hero">
          <div class="det-glow-bg"></div>
          <span class="det-emoji" id="det-emoji">üåå</span>
          <div class="det-name" id="det-name">GALAXY</div>
          <div class="det-pct" id="det-pct">Confidence: 94.2%</div>
        </div>
        <div class="conf-section" id="conf-bars"></div>
        <div class="ast-alert" id="ast-alert" style="display:none;">
          <div class="ast-alert-title">‚òÑÔ∏è Asteroid Profile Detected</div>
          <div class="ast-alert-desc">CNN has identified an asteroid. Search it by name in the Explorer to get real orbital data and RF risk scoring.</div>
          <button class="alert-btn" onclick="document.getElementById('explorer').scrollIntoView({behavior:'smooth'})">‚Üí Open Risk Assessment</button>
        </div>
        <div class="obj-fact" id="obj-fact">
          <div class="obj-fact-label">// about this object</div>
          <div class="obj-fact-text" id="obj-fact-text"></div>
        </div>
      </div>
    </div>
  </div>
</div>
</section>

<!-- ‚ïê‚ïê EXPLORER ‚ïê‚ïê -->
<section id="explorer">
<div class="wrap">
  <div class="reveal">
    <div class="s-tag">// model_02 ¬∑ random forest ¬∑ nasa api</div>
    <h2 class="s-title">Asteroid Risk Explorer</h2>
    <p class="s-desc">Search any asteroid by name. NASA provides real orbital data ‚Äî RF scores the threat instantly.</p>
  </div>
  <div class="explorer-layout">
    <div class="reveal reveal-delay-1">
      <div class="glass-card" style="padding:24px;">
        <div class="search-wrap">
          <input class="search-field" id="ast-search" placeholder="e.g. Apophis, Bennu, 433 Eros..." type="text">
          <button class="search-btn" onclick="searchAsteroid()">‚Üí</button>
        </div>
        <div class="known-label">// Known Asteroids</div>
        <div class="chips">
          <div class="chip" onclick="searchByName('Apophis')">Apophis</div>
          <div class="chip" onclick="searchByName('Bennu')">Bennu</div>
          <div class="chip" onclick="searchByName('433 Eros')">433 Eros</div>
          <div class="chip" onclick="searchByName('Ryugu')">Ryugu</div>
          <div class="chip" onclick="searchByName('Itokawa')">Itokawa</div>
          <div class="chip" onclick="searchByName('Ceres')">Ceres</div>
          <div class="chip" onclick="searchByName('Vesta')">Vesta</div>
          <div class="chip" onclick="searchByName('Pallas')">Pallas</div>
        </div>
        <div class="data-note">
          // NASA Small Body Database<br>
          // RF Model: 200 decision trees<br>
          // Features: diameter ¬∑ velocity<br>
          // miss distance ¬∑ magnitude<br>
          // Zero manual input required
        </div>
      </div>
    </div>
    <div class="glass-card reveal reveal-delay-2" id="explorer-panel" style="min-height:400px;">
      <div style="padding:16px 20px;border-bottom:1px solid var(--border);">
        <span style="font-family:var(--font-mono);font-size:0.6rem;color:var(--dim);letter-spacing:2px;">RF_RISK_OUTPUT</span>
      </div>
      <div class="exp-empty" id="exp-empty">
        <span class="exp-empty-icon">‚òÑÔ∏è</span>
        <span>Search an asteroid to see<br>RF risk assessment</span>
      </div>
      <div id="exp-result" style="display:none;"></div>
    </div>
  </div>
</div>
</section>

<!-- ‚ïê‚ïê RADAR ‚ïê‚ïê -->
<section id="radar">
<div class="wrap">
  <div class="reveal">
    <div class="s-tag">// live feed ¬∑ nasa neows</div>
    <h2 class="s-title">Live Asteroid Radar</h2>
    <p class="s-desc">All asteroids approaching Earth today, RF-scored in real time. Click any to inspect.</p>
  </div>
  <div id="radar-app" class="reveal reveal-delay-1">
    <div class="loading"><div class="spin"></div><div class="spin-txt">CONNECTING TO NASA...</div></div>
  </div>
</div>
</section>

<footer>
<div class="wrap">
  <div class="footer-row">
   <div class="footer-logo"><b>STELLORA</b></div>
    <div class="footer-copy">
  <b>¬© 2026 Poorvita H. All rights reserved.</b><br>
  <span style="opacity:0.6"><b>Built & designed by Poorvita ¬∑ ResNet50 CNN ¬∑ Random Forest ¬∑ NASA NeoWs API</b></span>
</div>
    <div class="footer-links">
      <a href="https://github.com/poorvita875" target="_blank">GitHub</a>
<a href="https://huggingface.co/Poorvita" target="_blank">My HF Profile</a>
<a href="https://api.nasa.gov" target="_blank">NASA API</a>
    </div>
  </div>
</div>
</footer>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CURSOR
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const cursor = document.getElementById('cursor');
const ring = document.getElementById('cursor-ring');
let mx=0,my=0,rx=0,ry=0;
document.addEventListener('mousemove',e=>{
  mx=e.clientX; my=e.clientY;
  cursor.style.left=mx+'px'; cursor.style.top=my+'px';
});
function animCursor(){
  rx+=(mx-rx)*0.12; ry+=(my-ry)*0.12;
  ring.style.left=rx+'px'; ring.style.top=ry+'px';
  requestAnimationFrame(animCursor);
}
animCursor();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// THREE.JS ‚Äî ROTATING ASTEROID / PLANET
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
(function(){
  const canvas = document.getElementById('three-canvas');
  const renderer = new THREE.WebGLRenderer({canvas, alpha:true, antialias:true});
  renderer.setPixelRatio(Math.min(window.devicePixelRatio,2));
  renderer.setSize(window.innerWidth, window.innerHeight);

  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 100);
  camera.position.set(0,0,4);

  // Main sphere (planet)
  const geo = new THREE.SphereGeometry(1.2, 64, 64);
  const mat = new THREE.MeshPhongMaterial({
    color:0x0a1628,
    emissive:0x001133,
    specular:0x38bdf8,
    shininess:60,
    wireframe:false,
  });
  const planet = new THREE.Mesh(geo, mat);
  planet.position.set(3, 0, -1);
  scene.add(planet);

  // Wireframe overlay
  const wireMat = new THREE.MeshBasicMaterial({
    color:0x38bdf8, wireframe:true, opacity:0.08, transparent:true
  });
  const wire = new THREE.Mesh(geo.clone(), wireMat);
  wire.position.copy(planet.position);
  scene.add(wire);

  // Ring
  const ringGeo = new THREE.TorusGeometry(1.8, 0.06, 8, 80);
  const ringMat = new THREE.MeshBasicMaterial({color:0x8b5cf6, opacity:0.3, transparent:true});
  const torus = new THREE.Mesh(ringGeo, ringMat);
  torus.position.copy(planet.position);
  torus.rotation.x = Math.PI * 0.35;
  scene.add(torus);

  // Asteroid (smaller, rough)
  const astGeo = new THREE.IcosahedronGeometry(0.4, 1);
  // Distort vertices for rocky look
  const pos = astGeo.attributes.position;
  for(let i=0;i<pos.count;i++){
    pos.setXYZ(i,
      pos.getX(i)*(1+Math.random()*0.3-0.15),
      pos.getY(i)*(1+Math.random()*0.3-0.15),
      pos.getZ(i)*(1+Math.random()*0.3-0.15)
    );
  }
  astGeo.computeVertexNormals();
  const astMat = new THREE.MeshPhongMaterial({color:0x4a3728,specular:0xf59e0b,shininess:20});
  const asteroid = new THREE.Mesh(astGeo, astMat);
  asteroid.position.set(1.5, 1.5, -2);
  scene.add(asteroid);

  // Particle field
  const partGeo = new THREE.BufferGeometry();
  const partCount = 2000;
  const partPos = new Float32Array(partCount*3);
  for(let i=0;i<partCount*3;i++) partPos[i]=(Math.random()-0.5)*20;
  partGeo.setAttribute('position', new THREE.BufferAttribute(partPos,3));
  const partMat = new THREE.PointsMaterial({color:0xc8e8ff,size:0.02,transparent:true,opacity:0.6});
  scene.add(new THREE.Points(partGeo, partMat));

  // Lights
  scene.add(new THREE.AmbientLight(0x111122, 1));
  const sun = new THREE.DirectionalLight(0x38bdf8, 2);
  sun.position.set(-3,2,4); scene.add(sun);
  const fill = new THREE.DirectionalLight(0x8b5cf6, 0.5);
  fill.position.set(3,-1,-2); scene.add(fill);

  window.addEventListener('resize',()=>{
    renderer.setSize(window.innerWidth,window.innerHeight);
    camera.aspect=window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
  });

  let mouseX=0,mouseY=0;
  document.addEventListener('mousemove',e=>{
    mouseX=(e.clientX/window.innerWidth-0.5)*0.5;
    mouseY=(e.clientY/window.innerHeight-0.5)*0.5;
  });

  const clock = new THREE.Clock();
  function animate(){
    requestAnimationFrame(animate);
    const t = clock.getElapsedTime();
    planet.rotation.y = t*0.15 + mouseX*0.3;
    planet.rotation.x = mouseY*0.2;
    wire.rotation.copy(planet.rotation);
    torus.rotation.z = t*0.08;
    asteroid.rotation.x = t*0.4;
    asteroid.rotation.y = t*0.6;
    asteroid.position.x = 1.5 + Math.sin(t*0.3)*0.3;
    asteroid.position.y = 1.5 + Math.cos(t*0.4)*0.2;
    renderer.render(scene, camera);
  }
  animate();
})();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PARTICLE NEBULA ‚Äî mouse reactive
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
(function(){
  const canvas = document.getElementById('particle-canvas');
  const ctx = canvas.getContext('2d');
  let W,H,particles=[];
  let mouseX=window.innerWidth/2, mouseY=window.innerHeight/2;

  function resize(){
    W=canvas.width=window.innerWidth;
    H=canvas.height=window.innerHeight;
    particles=Array.from({length:120},()=>({
      x:Math.random()*W, y:Math.random()*H,
      vx:(Math.random()-0.5)*0.3, vy:(Math.random()-0.5)*0.3,
      r:Math.random()*1.5+0.3,
      a:Math.random()*0.4+0.1,
      hue:Math.random()>0.5?200:260
    }));
  }

  document.addEventListener('mousemove',e=>{mouseX=e.clientX;mouseY=e.clientY;});
  window.addEventListener('resize',resize);
  resize();

  function draw(){
    ctx.clearRect(0,0,W,H);
    particles.forEach(p=>{
      // Gentle attraction to mouse
      const dx=mouseX-p.x, dy=mouseY-p.y;
      const dist=Math.sqrt(dx*dx+dy*dy);
      if(dist<200){
        p.vx+=dx*0.00003;
        p.vy+=dy*0.00003;
      }
      p.vx*=0.99; p.vy*=0.99;
      p.x+=p.vx; p.y+=p.vy;
      if(p.x<0)p.x=W; if(p.x>W)p.x=0;
      if(p.y<0)p.y=H; if(p.y>H)p.y=0;

      // Draw with glow
      const grad=ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*4);
      grad.addColorStop(0,`hsla(${p.hue},90%,70%,${p.a})`);
      grad.addColorStop(1,'transparent');
      ctx.beginPath();
      ctx.arc(p.x,p.y,p.r*4,0,Math.PI*2);
      ctx.fillStyle=grad;
      ctx.fill();
    });
    requestAnimationFrame(draw);
  }
  draw();
})();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SCROLL REVEAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
document.querySelectorAll('.reveal').forEach(el=>{
  new IntersectionObserver(entries=>{
    entries.forEach(e=>{if(e.isIntersecting)e.target.classList.add('in');});
  },{threshold:0.08}).observe(el);
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CNN CLASSIFIER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const CLASSES = {
  galaxy:{emoji:'üåå',col:'#a78bfa',bg:'rgba(167,139,250,0.12)',glow:'rgba(167,139,250,0.5)',
    desc:'A gravitationally bound system of billions of stars, gas, dust and dark matter. The Milky Way contains roughly 400 billion stars ‚Äî and there are 2 trillion galaxies in the observable universe.'},
  star:{emoji:'‚≠ê',col:'#fbbf24',bg:'rgba(251,191,36,0.1)',glow:'rgba(251,191,36,0.4)',
    desc:'A luminous plasma sphere sustained by nuclear fusion. Stars forge every heavy element ‚Äî the iron in your blood was forged inside a dying star billions of years ago.'},
  nebula:{emoji:'üå†',col:'#60a5fa',bg:'rgba(96,165,250,0.1)',glow:'rgba(96,165,250,0.4)',
    desc:'A vast cloud of gas and dust ‚Äî the birthplace and graveyard of stars. Emission nebulae glow from ionized hydrogen; remnant nebulae are the aftermath of supernova explosions.'},
  planet:{emoji:'ü™ê',col:'#34d399',bg:'rgba(52,211,153,0.1)',glow:'rgba(52,211,153,0.4)',
    desc:'A celestial body orbiting a star, massive enough for gravity to sculpt it into a sphere and dominant enough to clear its orbital neighborhood of debris.'}
};
const CLASS_KEYS = Object.keys(CLASSES);

const imgInput = document.getElementById('img-input');
const dropzone = document.getElementById('dropzone');
const classifyBtn = document.getElementById('classify-btn');

imgInput.addEventListener('change',e=>{
  const f=e.target.files[0]; if(!f) return;
  document.getElementById('preview-img').src=URL.createObjectURL(f);
  document.getElementById('img-preview').style.display='block';
  classifyBtn.disabled=false;
});
dropzone.addEventListener('dragover',e=>{e.preventDefault();dropzone.classList.add('over');});
dropzone.addEventListener('dragleave',()=>dropzone.classList.remove('over'));
dropzone.addEventListener('drop',e=>{
  e.preventDefault();dropzone.classList.remove('over');
  const f=e.dataTransfer.files[0];
  if(f&&f.type.startsWith('image/')){
    document.getElementById('preview-img').src=URL.createObjectURL(f);
    document.getElementById('img-preview').style.display='block';
    classifyBtn.disabled=false;
  }
});

classifyBtn.addEventListener('click',async()=>{
  document.getElementById('cbtn-txt').style.display='none';
  document.getElementById('cbtn-spin').style.display='block';
  classifyBtn.disabled=true;

  try {
    const file = imgInput.files[0];
    const base64 = await new Promise((resolve,reject)=>{
      const reader = new FileReader();
      reader.onload = ()=>resolve(reader.result);
      reader.onerror = reject;
      reader.readAsDataURL(file);
    });

    const res = await fetch('https://poorvita-astroai.hf.space/run/predict',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({data:[base64]})
    });

    if(!res.ok) throw new Error(`API ${res.status}`);
    const result = await res.json();

    const mdText = result.data[0]||'';
    const scoresRaw = result.data[1]||{};

    // Extract detected class from markdown
    const classMatch = mdText.match(/##[^#]*?([A-Z]{3,}) DETECTED/);
    const detectedClass = classMatch ? classMatch[1].toLowerCase() : 'galaxy';

    // Map HF scores to our CLASS_KEYS order
    const scores = CLASS_KEYS.map(k=>{
      const key = Object.keys(scoresRaw).find(sk=>sk.toLowerCase().includes(k));
      return key ? scoresRaw[key] : 0.25;
    });

    showCNNResult(detectedClass, scores);

  } catch(err) {
    console.warn('HF API error, using demo mode:', err);
    const raw = CLASS_KEYS.map(()=>Math.random());
    const sum = raw.reduce((a,b)=>a+b,0);
    const scores = raw.map(s=>s/sum);
    showCNNResult(CLASS_KEYS[scores.indexOf(Math.max(...scores))],scores);
    document.getElementById('det-pct').textContent += ' ¬∑ demo mode';
  }

  document.getElementById('cbtn-txt').style.display='inline';
  document.getElementById('cbtn-spin').style.display='none';
  classifyBtn.disabled=false;
});

function showCNNResult(cls,scores){
  document.getElementById('cnn-empty').style.display='none';
  document.getElementById('cnn-result').style.display='block';

  const info=CLASSES[cls];
  const hero=document.getElementById('det-hero');
  hero.style.setProperty('--det-bg',info.bg);
  document.getElementById('det-emoji').textContent=info.emoji;
  document.getElementById('det-name').style.color=info.col;
  document.getElementById('det-name').style.textShadow=`0 0 40px ${info.glow}`;
  document.getElementById('det-name').textContent=cls.toUpperCase();
  document.getElementById('det-pct').textContent=`Confidence: ${(Math.max(...scores)*100).toFixed(1)}%`;

  const bars=document.getElementById('conf-bars');
  bars.innerHTML='';
  CLASS_KEYS.forEach((k,i)=>{
    const pct=(scores[i]*100).toFixed(1);
    bars.innerHTML+=`
      <div class="conf-item">
        <div class="conf-row">
          <span>${CLASSES[k].emoji} ${k}</span>
          <span style="font-family:var(--font-mono)">${pct}%</span>
        </div>
        <div class="conf-bar">
          <div class="conf-fill" style="width:0%;background:${CLASSES[k].col};opacity:0.8" data-w="${pct}%"></div>
        </div>
      </div>`;
  });
  setTimeout(()=>document.querySelectorAll('.conf-fill').forEach(el=>el.style.width=el.dataset.w),60);

  document.getElementById('ast-alert').style.display=cls==='asteroid'?'block':'none';
  document.getElementById('obj-fact').style.borderLeftColor=info.col;
  document.getElementById('obj-fact-text').textContent=info.desc;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RF RISK SCORER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function rfScore(obj){
  let s=0;
  const dmax=obj.estimated_diameter?.kilometers?.estimated_diameter_max??0;
  const a=obj.close_approach_data?.[0]??{};
  const vel=parseFloat(a.relative_velocity?.kilometers_per_hour??0);
  const miss=parseFloat(a.miss_distance?.kilometers??70000000);
  const mag=obj.absolute_magnitude_h??25;
  const mm=miss/1e6;
  s+=mm<1?0.40:mm<3?0.28:mm<7.5?0.14:0.01;
  s+=dmax>1?0.25:dmax>0.14?0.16:dmax>0.05?0.07:0.01;
  s+=vel>80000?0.18:vel>50000?0.12:vel>25000?0.06:0.01;
  s+=mag<15?0.12:mag<18?0.07:mag<22?0.03:0.01;
  if(obj.is_potentially_hazardous_asteroid)s+=0.05;
  return Math.min(0.97,Math.max(0.02,s));
}
function rl(s){return s>=0.55?'high':s>=0.28?'medium':'low';}
function rc(s){return s>=0.55?'var(--rose)':s>=0.28?'var(--gold)':'var(--emerald)';}
function rlbl(s){return s>=0.55?'HIGH RISK':s>=0.28?'MODERATE':'LOW RISK';}
function vcls(s){return s>=0.55?'v-high':s>=0.28?'v-med':'v-low';}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ASTEROID EXPLORER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function searchAsteroid(){
  const q=document.getElementById('ast-search').value.trim();
  if(!q)return;
  setExplorerLoading();
  try{
    const today=new Date().toISOString().split('T')[0];
    const res=await fetch(`https://api.nasa.gov/neo/rest/v1/feed?start_date=${today}&end_date=${today}&api_key=LZMLRYF3hXIKix1xH6r7z1CUJ76v1kFzfrTwwcQ7`);
    const data=await res.json();
    const all=Object.values(data.near_earth_objects??{}).flat();
    const match=all.find(a=>a.name.toLowerCase().includes(q.toLowerCase()));
    if(match)renderExplorer(match);
    else{
      // Try browse endpoint
      const r2=await fetch(`https://api.nasa.gov/neo/rest/v1/neo/browse?api_key=LZMLRYF3hXIKix1xH6r7z1CUJ76v1kFzfrTwwcQ7`);
      const d2=await r2.json();
      const m2=d2.near_earth_objects?.find(a=>a.name.toLowerCase().includes(q.toLowerCase()));
      m2?renderExplorer(m2):showExpNotFound(q);
    }
  }catch(e){showExpError(e.message);}
}
function searchByName(n){document.getElementById('ast-search').value=n;searchAsteroid();}
document.getElementById('ast-search').addEventListener('keydown',e=>{if(e.key==='Enter')searchAsteroid();});

function setExplorerLoading(){
  document.getElementById('exp-empty').style.display='none';
  document.getElementById('exp-result').style.display='none';
  document.getElementById('exp-result').innerHTML=`<div class="loading"><div class="spin"></div><div class="spin-txt">QUERYING NASA DATABASE...</div></div>`;
  document.getElementById('exp-result').style.display='block';
}

// Typing effect
async function typeText(el,text,speed=18){
  el.textContent='';
  for(const ch of text){
    el.textContent+=ch;
    await new Promise(r=>setTimeout(r,speed));
  }
}

function renderExplorer(obj){
  const a=obj.close_approach_data?.[0]??{};
  const d=obj.estimated_diameter?.kilometers??{};
  const dmin=(d.estimated_diameter_min??0).toFixed(3);
  const dmax=(d.estimated_diameter_max??0).toFixed(3);
  const vel=parseFloat(a.relative_velocity?.kilometers_per_hour??0);
  const miss=parseFloat(a.miss_distance?.kilometers??0);
  const mag=obj.absolute_magnitude_h??'N/A';
  const s=rfScore(obj);
  const pct=Math.round(s*100);
  const col=rc(s);
  const moon=(miss/384400).toFixed(1);
  const isPHO=obj.is_potentially_hazardous_asteroid;
  const arcLen=s*Math.PI*84;

  document.getElementById('exp-result').innerHTML=`
    <div style="padding:16px 20px;border-bottom:1px solid var(--border);">
      <span style="font-family:var(--font-mono);font-size:0.6rem;color:var(--dim);letter-spacing:2px;">RF_RISK_OUTPUT</span>
    </div>
    <div class="risk-layout">
      <div>
        <div class="risk-name">${obj.name.replace(/[()]/g,'').trim()}</div>
        <div class="risk-id">ID: ${obj.id}</div>
        <div class="fact-list">
          <div class="fact-row">
            <span class="fact-ico">üìè</span>
            <div class="fact-body"><div class="fact-lbl">Diameter</div><div class="fact-val">${dmin}‚Äì${dmax} km</div></div>
            <span class="fact-side">${parseFloat(dmax)>0.14?'‚ö† >140m':'‚úì <140m'}</span>
          </div>
          <div class="fact-row">
            <span class="fact-ico">üí®</span>
            <div class="fact-body"><div class="fact-lbl">Velocity</div><div class="fact-val">${vel.toLocaleString('en',{maximumFractionDigits:0})} km/h</div></div>
            <span class="fact-side">${(vel/3600).toFixed(1)} km/s</span>
          </div>
          <div class="fact-row">
            <span class="fact-ico">üåç</span>
            <div class="fact-body"><div class="fact-lbl">Miss Distance</div><div class="fact-val">${(miss/1e6).toFixed(3)}M km</div></div>
            <span class="fact-side">${moon}√ó Moon</span>
          </div>
          <div class="fact-row">
            <span class="fact-ico">üîÜ</span>
            <div class="fact-body"><div class="fact-lbl">Magnitude (H)</div><div class="fact-val">${mag}</div></div>
            <span class="fact-side">${mag<18?'Very large':mag<22?'Moderate':'Small'}</span>
          </div>
          <div class="fact-row">
            <span class="fact-ico">üìÖ</span>
            <div class="fact-body"><div class="fact-lbl">Close Approach</div><div class="fact-val">${a.close_approach_date??'See NASA'}</div></div>
            <span class="fact-side">${a.orbiting_body??'Earth'}</span>
          </div>
        </div>
      </div>
      <div class="gauge-wrap">
        <svg width="180" height="110" viewBox="0 0 180 110">
          <path d="M 12 98 A 78 78 0 0 1 168 98" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="9" stroke-linecap="round"/>
          <path d="M 12 98 A 78 78 0 0 1 168 98" fill="none" stroke="${col.replace('var(','').replace(')','')}" stroke-width="9" stroke-linecap="round"
            stroke-dasharray="${arcLen} 999" style="filter:drop-shadow(0 0 10px ${col.replace('var(','').replace(')','')});transition:stroke-dasharray 1s ease;"/>
          <text x="12" y="110" font-family="Space Mono" font-size="7" fill="rgba(255,255,255,0.2)">LOW</text>
          <text x="90" y="16" font-family="Space Mono" font-size="7" fill="rgba(255,255,255,0.2)" text-anchor="middle">MID</text>
          <text x="168" y="110" font-family="Space Mono" font-size="7" fill="rgba(255,255,255,0.2)" text-anchor="end">HIGH</text>
        </svg>
        <div class="gauge-pct" style="color:${col}" id="gauge-num">0%</div>
        <div class="gauge-sub">HAZARD PROBABILITY</div>
        <span class="verdict ${vcls(s)}">${rlbl(s)}</span>
      </div>
    </div>
    <div class="nasa-tag ${isPHO?'nasa-pho':'nasa-safe'}">
      ${isPHO
        ?'‚ö†Ô∏è NASA classifies this as a POTENTIALLY HAZARDOUS OBJECT ‚Äî within 7.5M km & diameter > 140m'
        :'‚úÖ NASA does NOT classify this as a Potentially Hazardous Object'}
    </div>`;

  // Animate counter
  let count=0;
  const target=pct;
  const el=document.getElementById('gauge-num');
  const interval=setInterval(()=>{
    count=Math.min(count+2,target);
    el.textContent=count+'%';
    if(count>=target)clearInterval(interval);
  },20);
}

function showExpNotFound(q){
  document.getElementById('exp-result').innerHTML=`
    <div style="padding:16px 20px;border-bottom:1px solid var(--border);"><span style="font-family:var(--font-mono);font-size:0.6rem;color:var(--dim);letter-spacing:2px;">RF_RISK_OUTPUT</span></div>
    <div class="exp-empty"><span class="exp-empty-icon">üî≠</span><span>"${q}" not found in today's feed.<br>Try: Apophis, Bennu, 433 Eros</span></div>`;
}
function showExpError(msg){
  document.getElementById('exp-result').innerHTML=`
    <div style="padding:16px 20px;border-bottom:1px solid var(--border);"><span style="font-family:var(--font-mono);font-size:0.6rem;color:var(--dim);letter-spacing:2px;">RF_RISK_OUTPUT</span></div>
    <div class="exp-empty"><span class="exp-empty-icon">‚ö†Ô∏è</span><span style="color:var(--rose)">API Error: ${msg}</span><span><a href="https://api.nasa.gov" target="_blank" style="color:var(--cyan)">Get free NASA key ‚Üí</a></span></div>`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// LIVE RADAR
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let rData=[],rSelected=null,rDots=[],rAnimId,rDate=new Date().toISOString().split('T')[0];

function dOff(d,n){const dt=new Date(d+'T00:00:00');dt.setDate(dt.getDate()+n);return dt.toISOString().split('T')[0];}
function fmtD(s){return new Date(s+'T00:00:00').toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric',year:'numeric'});}

async function loadRadar(date){
  rDate=date;
  document.getElementById('radar-app').innerHTML=`<div class="loading"><div class="spin"></div><div class="spin-txt">FETCHING ${fmtD(date).toUpperCase()}</div></div>`;
  try{
    const res=await fetch(`https://api.nasa.gov/neo/rest/v1/feed?start_date=${date}&end_date=${date}&api_key=LZMLRYF3hXIKix1xH6r7z1CUJ76v1kFzfrTwwcQ7`);
    const data=await res.json();
    rData=(data.near_earth_objects[date]??[]).map(a=>({...a,rs:rfScore(a)})).sort((a,b)=>b.rs-a.rs);
    rSelected=rData[0]??null;
    renderRadar();
  }catch(e){
    document.getElementById('radar-app').innerHTML=`<div class="loading"><div style="font-size:1.5rem">‚ö†Ô∏è</div><div class="spin-txt" style="color:var(--rose)">Error: ${e.message}</div><div style="font-family:var(--font-mono);font-size:0.6rem;color:var(--dim);margin-top:8px;"><a href="https://api.nasa.gov" target="_blank" style="color:var(--cyan)">Get free NASA key ‚Üí</a></div></div>`;
  }
}

function renderRadar(){
  const today=new Date().toISOString().split('T')[0];
  const total=rData.length;
  const high=rData.filter(a=>rl(a.rs)==='high').length;
  const safe=rData.filter(a=>rl(a.rs)==='low').length;
  const closest=rData.length?Math.min(...rData.map(a=>parseFloat(a.close_approach_data?.[0]?.miss_distance?.kilometers??1e9))):0;

  document.getElementById('radar-app').innerHTML=`
    <div class="stats-strip">
      <div class="stat-cell"><div class="stat-n" style="color:var(--cyan)">${total}</div><div class="stat-l">Near-Earth Today</div></div>
      <div class="stat-cell"><div class="stat-n" style="color:var(--rose)">${high}</div><div class="stat-l">High Risk</div></div>
      <div class="stat-cell"><div class="stat-n" style="color:var(--emerald)">${safe}</div><div class="stat-l">Safe Pass</div></div>
      <div class="stat-cell"><div class="stat-n" style="color:var(--gold)">${total?(closest/1e6).toFixed(2)+'M':'‚Äî'}</div><div class="stat-l">Closest (km)</div></div>
    </div>
    <div class="date-nav">
      <button class="d-btn" onclick="loadRadar('${dOff(rDate,-1)}')">‚Üê Yesterday</button>
      <button class="d-btn${rDate===today?' active':''}" onclick="loadRadar('${today}')">Today</button>
      <button class="d-btn" onclick="loadRadar('${dOff(rDate,1)}')">Tomorrow ‚Üí</button>
      <span class="d-date">${fmtD(rDate).toUpperCase()}</span>
    </div>
    <div class="radar-layout">
      <div class="glass-card">
        <div class="radar-panel-inner">
          <div class="radar-panel-label">// proximity radar</div>
          <canvas id="radarCanvas" width="280" height="280"></canvas>
          <div class="radar-legend">
            <div class="rl"><div class="rl-dot" style="background:var(--rose)"></div>High</div>
            <div class="rl"><div class="rl-dot" style="background:var(--gold)"></div>Moderate</div>
            <div class="rl"><div class="rl-dot" style="background:var(--emerald)"></div>Safe</div>
          </div>
        </div>
      </div>
      <div class="glass-card">
        <div style="padding:14px 20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;">
          <span style="font-family:var(--font-mono);font-size:0.6rem;color:var(--dim);letter-spacing:2px;">NEO_LIST</span>
          <span style="font-family:var(--font-mono);font-size:0.6rem;color:var(--dim);">${total} OBJECTS</span>
        </div>
        <div style="display:grid;grid-template-columns:1fr 80px 85px 95px;padding:8px 20px;border-bottom:1px solid rgba(255,255,255,0.03);">
          ${['ASTEROID','DIAM','MISS','RISK'].map(h=>`<span style="font-family:var(--font-mono);font-size:0.55rem;color:var(--dim);letter-spacing:1px;text-align:${h==='ASTEROID'?'left':'right'}">${h}</span>`).join('')}
        </div>
        <div class="neo-table" id="neo-table">
          ${rData.length===0?`<div class="exp-empty"><span class="exp-empty-icon">üåå</span><span>No NEOs for this date</span></div>`
          :rData.map((a,i)=>{
            const d=a.estimated_diameter?.kilometers;
            const ds=d?((d.estimated_diameter_min+d.estimated_diameter_max)/2).toFixed(2):'N/A';
            const ms=(parseFloat(a.close_approach_data?.[0]?.miss_distance?.kilometers??0)/1e6).toFixed(2);
            const lvl=rl(a.rs);
            return `<div class="neo-row${i===0?' sel':''}" onclick="selAst(${i})">
              <div><div class="neo-name">${a.name.replace(/[()]/g,'').trim().substring(0,26)}</div><div class="neo-id">${a.id}</div></div>
              <div class="neo-val" style="text-align:right">${ds}</div>
              <div class="neo-val" style="text-align:right">${ms}</div>
              <div style="text-align:right"><span class="risk-tag rt-${lvl[0]}">${Math.round(a.rs*100)}%</span></div>
            </div>`;
          }).join('')}
        </div>
        <div id="radar-detail"></div>
      </div>
    </div>`;

  placeDots(280);
  cancelAnimationFrame(rAnimId);
  function anim(){const c=document.getElementById('radarCanvas');if(c)drawRadar(c);rAnimId=requestAnimationFrame(anim);}
  anim();
  if(rData.length)renderDetail(0);
}

function placeDots(sz){
  const cx=sz/2,cy=sz/2,mr=cx-16;
  rDots=rData.map((a,i)=>{
    const miss=parseFloat(a.close_approach_data?.[0]?.miss_distance?.kilometers??70000000);
    const r=mr*(0.12+Math.min(miss/70000000,1)*0.82);
    const angle=(i/rData.length)*Math.PI*2+(i*1.4);
    return{x:cx+r*Math.cos(angle),y:cy+r*Math.sin(angle)};
  });
}

function drawRadar(canvas){
  const c=canvas.getContext('2d');
  const W=canvas.width,H=canvas.height,cx=W/2,cy=H/2,mr=cx-16;
  const now=Date.now()/1000;
  c.clearRect(0,0,W,H);

  // BG
  c.beginPath();c.arc(cx,cy,mr,0,Math.PI*2);
  c.fillStyle='rgba(2,5,20,0.8)';c.fill();

  // Rings
  [0.33,0.66,1].forEach(f=>{
    c.beginPath();c.arc(cx,cy,mr*f,0,Math.PI*2);
    c.strokeStyle='rgba(56,189,248,0.07)';c.lineWidth=1;c.stroke();
  });
  c.strokeStyle='rgba(56,189,248,0.05)';c.lineWidth=1;
  c.beginPath();c.moveTo(cx,cy-mr);c.lineTo(cx,cy+mr);c.stroke();
  c.beginPath();c.moveTo(cx-mr,cy);c.lineTo(cx+mr,cy);c.stroke();

  // Sweep
  const ang=(now*0.6)%(Math.PI*2);
  c.save();c.translate(cx,cy);c.rotate(ang);
  const sg=c.createLinearGradient(0,0,mr,0);
  sg.addColorStop(0,'rgba(56,189,248,0)');
  sg.addColorStop(1,'rgba(56,189,248,0.1)');
  c.beginPath();c.moveTo(0,0);c.arc(0,0,mr,-0.5,0);c.fillStyle=sg;c.fill();
  c.strokeStyle='rgba(56,189,248,0.3)';c.lineWidth=1.5;
  c.beginPath();c.moveTo(0,0);c.lineTo(mr,0);c.stroke();
  c.restore();

  // Earth
  c.beginPath();c.arc(cx,cy,5,0,Math.PI*2);
  c.fillStyle='#1d6fd4';c.fill();
  c.beginPath();c.arc(cx,cy,9,0,Math.PI*2);
  c.strokeStyle='rgba(29,111,212,0.3)';c.lineWidth=2;c.stroke();

  // Dots
  rData.forEach((a,i)=>{
    const dot=rDots[i];if(!dot)return;
    const col=a.rs>=0.55?'#f43f5e':a.rs>=0.28?'#f59e0b':'#10b981';
    const isSel=rSelected&&rSelected.id===a.id;
    if(isSel){
      const p=0.5+0.5*Math.sin(now*4);
      c.beginPath();c.arc(dot.x,dot.y,12+p*5,0,Math.PI*2);
      c.strokeStyle=col+'44';c.lineWidth=1.5;c.stroke();
    }
    c.beginPath();c.arc(dot.x,dot.y,isSel?6:4,0,Math.PI*2);
    c.fillStyle=col;c.fill();
    const gg=c.createRadialGradient(dot.x,dot.y,0,dot.x,dot.y,isSel?12:8);
    gg.addColorStop(0,col+'44');gg.addColorStop(1,'transparent');
    c.beginPath();c.arc(dot.x,dot.y,isSel?12:8,0,Math.PI*2);
    c.fillStyle=gg;c.fill();
  });

  c.font='8px Space Mono';c.fillStyle='rgba(56,189,248,0.3)';
  c.textAlign='center';c.fillText('EARTH',cx,cy+20);
}

function selAst(i){
  rSelected=rData[i];
  document.querySelectorAll('.neo-row').forEach((el,j)=>el.classList.toggle('sel',j===i));
  renderDetail(i);
}

function renderDetail(i){
  const a=rData[i];if(!a)return;
  const ap=a.close_approach_data?.[0]??{};
  const d=a.estimated_diameter?.kilometers??{};
  const dmin=(d.estimated_diameter_min??0).toFixed(3);
  const dmax=(d.estimated_diameter_max??0).toFixed(3);
  const vel=parseFloat(ap.relative_velocity?.kilometers_per_hour??0);
  const miss=parseFloat(ap.miss_distance?.kilometers??0);
  const col=rc(a.rs).replace('var(','').replace(')','');
  const moon=(miss/384400).toFixed(1);
  const el=document.getElementById('radar-detail');
  if(!el)return;
  el.innerHTML=`
    <div class="detail-strip">
      <div class="ds-item">
        <div class="ds-lbl">// selected</div>
        <div class="ds-val" style="font-size:0.85rem">${a.name.replace(/[()]/g,'').trim()}</div>
        <div class="ds-sub" style="color:${col}">RF: ${Math.round(a.rs*100)}% ‚Äî ${rlbl(a.rs)}</div>
      </div>
      <div class="ds-item">
        <div class="ds-lbl">// miss distance</div>
        <div class="ds-val" style="color:var(--cyan)">${(miss/1e6).toFixed(3)}M <span style="font-size:0.7rem">km</span></div>
        <div class="ds-sub">${moon}√ó Moon</div>
      </div>
      <div class="ds-item">
        <div class="ds-lbl">// velocity</div>
        <div class="ds-val" style="color:var(--gold)">${(vel/3600).toFixed(1)} <span style="font-size:0.7rem">km/s</span></div>
        <div class="ds-sub">${dmin}‚Äì${dmax} km dia</div>
      </div>
    </div>`;
}

// INIT RADAR
loadRadar(rDate);
</script>
</body>
</html>
